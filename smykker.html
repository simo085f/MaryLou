<!DOCTYPE html>
<html lang="">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="smykker.css" type="text/css">
     <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">
    <!--Den nedstående <link rel> bruges for at hente et ikon fra w3schools -https://www.w3schools.com/icons/tryit.asp?icon=fas_fa-shopping-basket&unicon=f291 -->
    <link rel='stylesheet' href='https://use.fontawesome.com/releases/v5.5.0/css/all.css' integrity='sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU' crossorigin='anonymous'>

    <title>Smykker</title>
</head>

<body>
    <div class="dropdown">
    <button onclick="dropFunction()" class="dropknap">FILTRERING</button>
    <div id="drop" class="content">
        <div class="menu_item" data_kategori="alle">ALLE</div>
            <div class="menu_item" data_kategori="Ringe">RINGE</div>
            <div class="menu_item" data_kategori="Øreringe">ØRERINGE</div>
            <div class="menu_item" data_kategori="Armbånd">ARMBÅND</div>
            <div class="menu_item" data_kategori="Halskæder">HALSKÆDER</div>
            <div class="menu_item" data_kategori="Vedhæng">VEDHÆNG</div>

        </div>

    </div>

    <nav>
    <section id="filtrering">
            <div class="knapper">
            <div class="menu_item" data_kategori="alle">ALLE</div>
            <div class="menu_item" data_kategori="Ringe">RINGE</div>
            <div class="menu_item" data_kategori="Øreringe">ØRERINGE</div>
            <div class="menu_item" data_kategori="Armbånd">ARMBÅND</div>
            <div class="menu_item" data_kategori="Halskæder">HALSKÆDER</div>
            <div class="menu_item" data_kategori="Vedhæng">VEDHÆNG</div>
                <h1></h1>
                <!--Ikonet er hentet fra w3schools - https://www.w3schools.com/icons/tryit.asp?icon=fas_fa-shopping-basket&unicon=f291-->
                <i class='fas fa-shopping-basket' style='font-size:18px; color:#F18FAB; width: 20px; height: 20px; margin-top: 8px;'></i>
            </div>
        </section>
        </nav>
    <main>



        <section class="smykker"></section>
        <template class="smykke-template">
        <article class="smykke-container">
            <img class="image" src="" alt="">
            <div id="text1">
            <div class="titel"></div>
            <div class="pris"></div>
            <button class="koeb">Læs mere</button>
                </div>
            <div class="kategori"></div>


            </article>
        </template>

    </main>

    <script>


    document.addEventListener("DOMContentLoaded", getJson);

    let alleSmykker;
    let smykkeTemplate = document.querySelector(".smykke-template");
    let smykkeContainer = document.querySelector(".smykker");


    smykkeFilter="alle";

        async function getJson(){
            let jsonData = await fetch("https://camilla-pedersen.dk/kea/MaryLou/wordpress/wp-json/wp/v2/posts");
            alleSmykker = await jsonData.json();
            console.log(alleSmykker);
            visSmykker();
        }

        document.querySelectorAll(".menu_item").forEach(knap =>{
            knap.addEventListener("click", filtrering);
        })

        function filtrering(){
            smykkeContainer.textContent="";
            smykkeFilter = this.getAttribute("data_kategori");
            visSmykker();
        }

        function visSmykker(){
            console.log(visSmykker + smykkeFilter);
            alleSmykker.forEach(smykke =>{
                if(smykkeFilter == smykke.acf.kategori){
                    udskriv();
                } else if(smykkeFilter == "alle"){
                    udskriv();
                }

                function udskriv(){
                    let klon = smykkeTemplate.cloneNode(true).content;

                    klon.querySelector(".pris").textContent = smykke.acf.pris + "kr";
                    klon.querySelector(".image").src = smykke.acf.billede;
                    klon.querySelector(".titel").textContent = smykke.title.rendered;


 klon.querySelector("img").addEventListener("click", () =>{
                       window.location.href = "single.html?id=" + smykke.id;
                  });

                    smykkeContainer.appendChild(klon);
                }
            })
        }

          function dropFunction(){
            document.querySelector("#drop").classList.toggle("visContent");
        }

        window.onclick = function(event){
            if(!event.target.matches('.dropknap')){
                var dropdowns = document.querySelector(".content");
                var i;
                for (i = 0; i < dropdowns.length; i++){
                    var openDrop = dropdowns[i];
                    if (openDrop.classList.contains('show')){
                        openDrop.classList.remove(
                        'show');
                    }
                }
            }
        }

        //Luk Side navigation til mobilstørrelse
        function closeMenu(){
            document.querySelector(".dropdown").style.width = "0";
        }
    </script>
</body>
</html>
